{% extends "my_canteen/base.html" %}
{% block content %}

<h2>ðŸ‘· Staff Dashboard</h2>

<div class="dashboard-tabs">
    <button class="tab-btn" onclick="showTab('orders')">ðŸ“¦ Processing Orders</button>
    <button class="tab-btn" onclick="showTab('profile')">ðŸ‘¤ Profile</button>
</div>

<!-- Orders Section -->
<div id="orders" class="tab-content active">
    <h3>Processing Orders (Accepted / Preparing)</h3>
    <table class="orders-table">
        <tr>
            <th>#</th>
            <th>User</th>
            <th>Items</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
        {% for order in orders %}
        <tr>
            <td>#{{ order.id }}</td>
            <td>{{ order.user.username }}</td>
            <td>
                {% for oi in order.orderitem_set.all %}
                    {{ oi.item.name }} Ã— {{ oi.quantity }}<br>
                {% endfor %}
            </td>
            <td class="status {{ order.status }}">{{ order.status }}</td>
            <td>
                <!-- Preparing Button -->
                <form method="post" action="{% url 'order_preparing' order.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button class="btn" {% if order.status == "preparing" or order.status == "ready" or order.status == "completed" %}disabled{% endif %}>
                        Preparing
                    </button>
                </form>

                <!-- Ready Button -->
                <form method="post" action="{% url 'order_ready' order.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button class="btn" {% if order.status == "ready" or order.status == "completed" %}disabled{% endif %}>
                        Ready
                    </button>
                </form>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="5">No processing orders.</td></tr>
        {% endfor %}
    </table>
</div>

<!-- Profile Section -->
<div id="profile" class="tab-content">
    <h3>Profile</h3>
    <div class="profile-card">
        <p><strong>Name:</strong> {{ profile.user.username }}</p>
        <p><strong>Email:</strong> {{ profile.user.email }}</p>
    </div>
</div>

<script>
function showTab(tabId) {
    document.querySelectorAll('.tab-content').forEach(div => div.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
}
</script>

{% endblock %}
