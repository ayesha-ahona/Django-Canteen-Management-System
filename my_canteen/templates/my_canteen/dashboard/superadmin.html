{% extends "my_canteen/base.html" %}
{% block content %}
<h2>👑 Super Admin Dashboard</h2>

<div class="dashboard-tabs">
  <button class="tab-btn" onclick="showTab('orders')">📦 Manage Orders</button>
  <button class="tab-btn" onclick="showTab('menu')">📋 Manage Menu</button>
  <button class="tab-btn" onclick="showTab('users')">👥 Manage Users</button>
  <button class="tab-btn" onclick="showTab('reports')">📊 Reports</button>
  <button class="tab-btn" onclick="showTab('settings')">⚙️ Settings</button>
  <button class="tab-btn" onclick="showTab('profile')">👤 Profile</button>
</div>

<div id="orders" class="tab-content active">
  <h3>All Orders</h3>
  <table class="orders-table">
    <tr>
      <th>#</th><th>User</th><th>Items</th><th>Total</th><th>Payment</th><th>Status</th><th>Actions</th>
    </tr>
    {% for order in orders %}
    <tr>
      <td>#{{ order.id }}</td>
      <td>{{ order.user.username }}</td>
      <td>
        {% for oi in order.orderitem_set.all %}
          {{ oi.item.name }} x {{ oi.quantity }} <br>
        {% endfor %}
      </td>
      <td>{{ order.total_price }} Tk</td>
      <td>{{ order.payment_status|capfirst }}</td>
      <td class="status {{ order.status }}">{{ order.status }}</td>
      <td>
        <form method="post" action="{% url 'order_accept' order.id %}" style="display:inline;">{% csrf_token %}<button class="btn">Accept</button></form>
        <form method="post" action="{% url 'order_preparing' order.id %}" style="display:inline;">{% csrf_token %}<button class="btn">Preparing</button></form>
        <form method="post" action="{% url 'order_ready' order.id %}" style="display:inline;">{% csrf_token %}<button class="btn">Ready</button></form>
        <form method="post" action="{% url 'order_delivered' order.id %}" style="display:inline;">{% csrf_token %}<button class="btn">Delivered</button></form>
        <form method="post" action="{% url 'order_mark_paid' order.id %}" style="display:inline;">{% csrf_token %}<button class="btn">Mark Paid</button></form>
        <form method="post" action="{% url 'order_completed' order.id %}" style="display:inline;">{% csrf_token %}<button class="btn">Complete</button></form>
        <form method="post" action="{% url 'order_cancel' order.id %}" style="display:inline;">{% csrf_token %}<button class="btn">Cancel</button></form>
      </td>
    </tr>
    {% empty %}
      <tr><td colspan="7">No orders.</td></tr>
    {% endfor %}
  </table>
</div>

<div id="menu" class="tab-content"><h3>Menu Management</h3><p>Add/Update menu from Admin panel for now.</p></div>
<div id="users" class="tab-content"><h3>User Management</h3><p>Future: Manage users here.</p></div>
<div id="reports" class="tab-content"><h3>Reports</h3><p>Future: Sales & Stock reports.</p></div>
<div id="settings" class="tab-content"><h3>Settings</h3><p>Full control over system.</p></div>

<div id="profile" class="tab-content">
  <h3>Profile</h3>
  <div class="profile-card">
    <p><strong>Name:</strong> {{ profile.user.username }}</p>
    <p><strong>Email:</strong> {{ profile.user.email }}</p>
    <p><strong>Phone:</strong> {{ profile.phone }}</p>
  </div>
</div>

<script>
function showTab(id){document.querySelectorAll('.tab-content').forEach(d=>d.classList.remove('active'));document.getElementById(id).classList.add('active');}
</script>
{% endblock %}
